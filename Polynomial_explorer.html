<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive Polynomial Explorer</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 1000px; margin: auto; }
    .controls { margin-bottom: 20px; }
    .sliders { margin-top: 10px; }
    .slider-group { margin-bottom: 10px; }
    .info-panel { margin-top: 20px; background: #f9f9f9; padding: 15px; border-radius: 8px; }
  </style>
</head>
<body>

  <h2>ðŸ§® Interactive Polynomial Explorer</h2>

  <div class="controls">
    <label for="degree">Select polynomial degree (1â€“5): </label>
    <select id="degree">
      <option value="1">1 (Linear)</option>
      <option value="2">2 (Quadratic)</option>
      <option value="3">3 (Cubic)</option>
      <option value="4">4 (Quartic)</option>
      <option value="5">5 (Quintic)</option>
    </select>
  </div>

  <div id="sliders" class="sliders"></div>

  <div id="plot" style="width: 100%; height: 400px;"></div>

  <div class="info-panel">
    <h3>ðŸ“Š Polynomial Properties</h3>
    <div id="properties"></div>
  </div>

  <script>
    const slidersDiv = document.getElementById("sliders");
    const degreeSelector = document.getElementById("degree");
    const plotDiv = document.getElementById("plot");
    const propsDiv = document.getElementById("properties");

    let sliders = [];
    let coeffs = [];

    function createSliders(degree) {
      slidersDiv.innerHTML = "";
      sliders = [];
      coeffs = [];

      for (let i = degree; i >= 0; i--) {
        const group = document.createElement("div");
        group.className = "slider-group";
        const label = document.createElement("label");
        label.innerText = `Coefficient of x^${i}: `;
        const input = document.createElement("input");
        input.type = "range";
        input.min = -10;
        input.max = 10;
        input.step = 0.1;
        input.value = i === degree ? 1 : 0; // leading coefficient 1 by default
        input.dataset.power = i;

        const span = document.createElement("span");
        span.innerText = input.value;

        input.oninput = () => {
          span.innerText = input.value;
          updateGraph();
        };

        group.appendChild(label);
        group.appendChild(input);
        group.appendChild(span);
        slidersDiv.appendChild(group);

        sliders.push(input);
      }
      updateGraph();
    }

    function getPolynomialExpr() {
      let terms = sliders.map(s => {
        let coef = parseFloat(s.value);
        let pow = s.dataset.power;
        if (coef === 0) return null;
        if (pow === "0") return `${coef}`;
        if (coef === 1) return `x^${pow}`;
        if (coef === -1) return `-x^${pow}`;
        return `${coef}*x^${pow}`;
      }).filter(Boolean);
      return terms.length ? terms.join(" + ") : "0";
    }

    function updateGraph() {
      const expr = getPolynomialExpr();
      const node = math.parse(expr);
      const f = node.compile();

      const df = math.derivative(node, 'x').compile();
      const ddf = math.derivative(math.derivative(node, 'x'), 'x').compile();

      const x_vals = math.range(-10, 10, 0.1).toArray();
      const y_vals = x_vals.map(x => f.evaluate({ x }));
      const dy = x_vals.map(x => df.evaluate({ x }));
      const ddy = x_vals.map(x => ddf.evaluate({ x }));

      // Plot
      Plotly.newPlot(plotDiv, [{
        x: x_vals, y: y_vals, mode: 'lines', name: 'f(x)'
      }], {
        margin: { t: 20 }, title: `f(x) = ${expr.replace(/\*/g, '')}`
      });

      // Info panel
      const increasing = [];
      const decreasing = [];
      const concaveUp = [];
      const concaveDown = [];
      let inflections = [];

      for (let i = 1; i < x_vals.length; i++) {
        if (dy[i - 1] < 0 && dy[i] > 0) increasing.push(`[${x_vals[i - 1].toFixed(1)}, ${x_vals[i].toFixed(1)}]`);
        if (dy[i - 1] > 0 && dy[i] < 0) decreasing.push(`[${x_vals[i - 1].toFixed(1)}, ${x_vals[i].toFixed(1)}]`);
        if (Math.sign(ddy[i - 1]) !== Math.sign(ddy[i])) inflections.push(x_vals[i].toFixed(2));
        if (ddy[i] > 0) concaveUp.push(x_vals[i]);
        if (ddy[i] < 0) concaveDown.push(x_vals[i]);
      }

      propsDiv.innerHTML = `
        <strong>Increasing Intervals:</strong> ${increasing.join(', ') || 'None'}<br/>
        <strong>Decreasing Intervals:</strong> ${decreasing.join(', ') || 'None'}<br/>
        <strong>Concave Up:</strong> x â‰ˆ ${concaveUp.length ? concaveUp[0].toFixed(2) + "..." : "None"}<br/>
        <strong>Concave Down:</strong> x â‰ˆ ${concaveDown.length ? concaveDown[0].toFixed(2) + "..." : "None"}<br/>
        <strong>Inflection Points:</strong> x â‰ˆ ${inflections.join(', ') || 'None'}
      `;
    }

    // Initialize
    degreeSelector.addEventListener("change", () => {
      createSliders(parseInt(degreeSelector.value));
    });

    createSliders(parseInt(degreeSelector.value));
  </script>

</body>
</html>
